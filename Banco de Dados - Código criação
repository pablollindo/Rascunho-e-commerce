-- Criar banco
CREATE DATABASE perifericos_store;
USE perifericos_store;

-- Tabela usuários
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    senha VARCHAR(255) NOT NULL,
    tipo ENUM('cliente','admin') DEFAULT 'cliente',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela categorias
CREATE TABLE categories (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(50) NOT NULL
);

-- Tabela produtos
CREATE TABLE products (
    id INT AUTO_INCREMENT PRIMARY KEY,
    categoria_id INT,
    nome VARCHAR(100) NOT NULL,
    preco DECIMAL(10,2) NOT NULL,
    estoque INT NOT NULL,
    imagem VARCHAR(255),
    descricao TEXT,
    destaque BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (categoria_id) REFERENCES categories(id)
);

-- Tabela pedidos
CREATE TABLE orders (
    id INT AUTO_INCREMENT PRIMARY KEY,
    cliente_id INT,
    total DECIMAL(10,2) NOT NULL,
    status ENUM('pendente','pago','enviado','entregue') DEFAULT 'pendente',
    metodo_pagamento ENUM('cartao','pix','boleto'),
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    endereco TEXT,
    FOREIGN KEY (cliente_id) REFERENCES users(id)
);

-- Tabela itens do pedido
CREATE TABLE order_items (
    id INT AUTO_INCREMENT PRIMARY KEY,
    pedido_id INT,
    produto_id INT,
    quantidade INT NOT NULL,
    valor_unitario DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (pedido_id) REFERENCES orders(id),
    FOREIGN KEY (produto_id) REFERENCES products(id)
);

-- Dados iniciais
INSERT INTO categories (nome) VALUES 
('Teclados'), ('Mouses'), ('Headsets'), ('Monitores'), ('Webcams');

INSERT INTO users (nome, email, senha, tipo) VALUES 
('Admin', 'admin@loja.com', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'admin');

INSERT INTO products (categoria_id, nome, preco, estoque, descricao, destaque) VALUES
(1, 'Teclado Mecânico RGB', 299.90, 25, 'Teclado mecânico com switches blue e iluminação RGB', 1),
(2, 'Mouse Gamer 7200DPI', 159.90, 30, 'Mouse gamer com sensor óptico 7200DPI', 1),
(3, 'Headset Gamer 7.1', 199.90, 20, 'Headset surround 7.1 com microfone retrátil', 1);
